---

copyright:
  years: 2017
lastupdated: "2018-11-10"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}
{:faq: data-hd-content-type='faq'}

# IBM 虚拟路由器设备的常见问题
{: #faqs-for-ibm-virtual-router-appliance}

下面是使用 IBM© 虚拟路由器设备 (VRA) 时的常见问题。

## 什么是 VRA？ 
{:faq}

虚拟路由器设备 (VRA) 支持 IBM Cloud 客户通过全功能的企业路由器（具有防火墙、流量塑形、基于策略的路由、VPN 和其他诸多功能）有选择地路由专用和公用网络流量。所有 VRA 功能均由客户管理。VRA 给予 IBM Cloud 客户一定程度的控制权，而这种程度的控制权通常是保留用于内部部署网络的。

## 什么是网关设备？ 
{:faq}

通过网关设备装置，可以使用 Web 门户网站或 API 来选择要通过 VRA 路由的网络分段 (VLAN)。您可以随时更改选择的 VLAN。网关设备还可处理 VRA 高可用性 (HA)，配置第二个 VRA 以在第一个 VRA 发生故障时进行接管。

## 有时，我会看到对“Vyatta”和“vRouter”之类的术语的引用。它们与 VRA 有什么关系？
{:faq}

Vyatta 原本是一个基于 PC 的开放式源代码路由器软件，但被全面收购后已转变为封闭式源代码。如今，“Vyatta”和“Vyatta 操作系统”都描述的是派生自该封闭式源代码项目的商业软件改写。IBM VRA 包含 Vyatta 操作系统的元素，以及通过 IBM Cloud 独家提供的针对功能和服务的重大改进。

“vRouter”是 Vyatta 当时所有者对其进行的暂时更名。在文档中看到时，可以将其视为与 Vyatta 同义。

## 是否仍支持 Vyatta 5400？
{:faq}

从 2019 年 3 月 31 日开始，IBM 将不再支持 Vyatta 5400。

## 虚拟路由器设备 (Vyatta 5600) 相比 Vyatta 5400 进行了哪些改进？
{:faq}

相比 Vyatta 5400，Vyatta 5600 提供了以下增强功能：

- 吞吐速度更快，每个 CPU 核心高达 10 Gbps
- 每个 IPsec VPN 会话的吞吐量提高为 3 倍以上（高级加密标准）
- 增大了路由器、流和并发连接的容量
- 更新了标准支持，包括第 2 层隧道协议 V3 (L2TPv3)、因特网密钥交换 V2 (IKEv2)、安全散列算法 2 (SHA-2) 和 802.1Q 隧道 (Q-in-Q) 封装

## AT&T vRouter 5600 产品是什么情况？
{:faq}

AT&T（原名为 Brocade）已声明其 Brocade vRouter 5600 产品寿命终止，不再提供支持。虽然 Brocade vRouter 5600 为 IBM 虚拟路由器设备提供底层技术功能，但此声明不适用于 IBM 客户。IBM 客户使用此新产品时将继续享有支持。

## VRA 如何交付？ 
{:faq}

您可通过订购网关来获取 VRA。通过这一简化的流程，您可选择数据中心和适用的 VRA 服务器，以及是否要部署 HA 对形式的 VRA。服务器、操作系统和网关设备装置全部都会自动供应。供应完成后，可以使用网关设备接口通过 VRA 来路由 VLAN。您可以使用 SSH（安全 Shell）和客户门户网站的“硬件详细信息”部分中提供的密码来直接配置 VRA 服务器。

## 我的密码是否安全？ 
{:faq}

安全。所有 VRA 都分配有仅对帐户持有者可视的随机密码。如同 SSH 公用密钥和管理 IP 访问限制那样，密码可轻松更改。

## 可以在没有网关设备的情况下获取 VRA 吗？ 
{:faq}

可以，但获取的 VRA 只能管理 VRA 的公用接口和专用接口之间的流量。VLAN 和 HA 需要网关设备装置。

## 是否所有网络流量都通过 VRA 发送？ 
{:faq}

不是。网关设备支持您选择要通过 VRA 路由的专用和公用网络分段 (VLAN)。您可以随时更改和绕过选择的 VLAN。VRA 还支持定义应用于子网或 IP 范围的基于 IP 的规则。仅当包含这些子网的 VLAN 通过 VRA 进行路由时，这些规则才起作用。

## VRA 或专用防火墙是否会阻止新的服务器供应？ 
{:faq}

会阻止。所以只要有可能，在将您计划使用的服务器填充进网络之前，您都不应当锁定网络。

策略禁止 IBM 支持人员在没有客户明确参与的情况下检查或更改 VRA 或专用防火墙配置，因此在大多数情况下，支持人员无法知道某个 VRA 是否对已停止或失败的服务器供应负有责任。

客户有责任确保将 VRA 或防火墙配置为在服务器订单下达之前允许自动服务器供应。客户管理的 VRA 或防火墙所阻止的供应由客户负责解决。此类供应延迟不受 SLA 或信用值的约束。如果客户没有快速响应，那么订购的系统可能会退还给库存（在擦除客户数据后）。

同样，如果下单后绕过 VRA/防火墙，那么订单仍可能失败。可能会在很短的时段内尝试进行自动重试。因此，最好是使整个供应过程持续执行，而没有网络干扰。

## IBM 提供哪些防火墙产品？
{:faq}

您可以通过查看[此主题](/docs/infrastructure/fortigate-10g?topic=fortigate-10g-exploring-firewalls)来找到 IBM Cloud 中提供的所有防火墙产品的详细比较。 

## VRA 是否会影响客户支持工作？ 
{:faq}

会，原因如上所述。VRA 是一个“黑匣”：进去的是 VLAN，出来的也是 VLAN，IBM 并不知道客户对这中间的包执行了哪些操作。

支持人员总是会竭尽所能提供支持，但对于 VRA 和专用防火墙，存在以下情况：a) 客户隐私优先于连接；b) 我们的标准支持人员没有能力分析格式不良或高度复杂的 VRA/防火墙配置。

作为第一个诊断步骤，我们可能需要您将 VRA 或防火墙 VLAN 放入旁路中。如果在此状态下，之前失败的供应开始正常运作，那么我们一定会认定问题出在 VRA/防火墙配置上。

## VRA 对网络性能有什么影响？ 
{:faq}

请记住，尽管其他客户看不到您，但公共云会与这些客户共享网络。真正的最佳“VRA”吞吐量根据某个时间点的可用网络容量以及数据必须传递的距离来确定。

除了这些变量外，VRA 能够使用粗略计算公式以 80 Gbps 的速度转发多个接口上未经修改的流量，公式为每 10 Gbps 吞吐量需要一个完整的处理器核心（不包括超线程）。鉴于当前服务器的最大输出为 40 Gbps（2 个 10 Gbps 公用 + 2 个 10 Gbps 专用），带有 8 个或更多核心的服务器应该有足够的计算空余空间来以近最佳网络性能处理多个常用 VRA 功能。

## 如果丢失了 VRA 密码该怎么办？
{:faq}

如果有对系统的访问权，请通过运行以下命令来设置新密码：

```
set system login user [account] authentication plaintext-password [password]  
```

如果无权访问系统，那么可以重新引导设备，然后使用 GRUB 菜单上的“密码恢复”选项来重置 root 用户密码。

## 如果防火墙阻止我访问该怎么办？
{:faq}

在测试可能存在危险的防火墙规则时，`reboot at [time]` 构造会非常有用。

如果规则正常工作，请使用 `reboot cancel` 命令来取消重新引导。如果规则阻止您访问，只需等待调度的重新引导执行即可。

如果没有对系统的访问权，那么可以使用重新引导来恢复访问权。在重新引导时，系统将读取配置文件，已废弃的先前条目不会更改此文件。

如果有使用 IPMI 的访问权，那么可以执行以下操作来恢复访问权：

1. 通过运行以下命令，禁用违规规则：

	```
	set security firewall name [firewall name] rule [rule number] disable
	commit
	```

2. 通过运行以下命令，解除整个指定规则集与必要接口的关联：

	```
	delete interfaces dataplane [interface] firewall [type][firewall name]
	commit
	```

**注：**错误使用这些命令可能会擦除接口配置。

## 该如何启用对 VRA 的 root 用户登录？
{:faq}

要启用通过 SSH 进行的 root 用户访问，请运行以下命令：

`set service ssh allow-root`

请注意，允许使用 SSH 进行 root 用户访问被视为不安全。访问根 shell 的另一种方法是以其他用户身份登录，然后使用 `su -` 本地升级到 root 用户，或者允许使用 sudo 命令升级到“超级用户”。 

例如，要以超级用户身份配置 Vyatta，请运行以下命令：

`set system login vyatta level superuser`
